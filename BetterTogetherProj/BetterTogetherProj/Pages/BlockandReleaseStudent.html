<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
    <script src="https://kit.fontawesome.com/a076d05399.js"></script>

    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.19/css/dataTables.bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/responsive/2.2.3/css/responsive.dataTables.min.css">

    <script src="../Scripts/jquery-3.4.1.min.js"></script>
    <link href="MyStyleSheet.css" rel="stylesheet" />
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/responsive/2.2.3/js/dataTables.responsive.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/1.10.19/js/dataTables.bootstrap.min.js"></script>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script src="../Scripts/ajaxCalls.js"></script>

    <script src="//cdn.tinymce.com/4/tinymce.min.js"></script>
    <script>tinymce.init({ selector: 'textarea' });</script>

    <!--<script src="https://cdn.anychart.com/releases/8.7.1/js/anychart-base.min.js"></script>
    <script src="https://cdn.anychart.com/releases/8.7.1/themes/dark_turquoise.min.js"></script>-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>

    <script>
        $(document).ready(function () {


            ajaxCall("GET", "../api/Ads/getStudentsByActivity", "", getSuccessallstudents, error);
           
            $("#block").change(blockReleaseStudent);
            $("#release").change(blockReleaseStudent);



        });

        function getSuccessallstudents(studentsData) {
            console.log(studentsData)
            studentsDataa = studentsData;
            str = "<option>בחר סטודנט לחסימה</option>";
            strl = "<option>בחר סטודנט לשחרור</option>";
            for (var i = 0; i < studentsDataa[0].length; i++) {
             
                str += "<option value="+studentsDataa[0][i].Mail+">" + studentsDataa[0][i].Fname +" "+ studentsDataa[0][i].Lname+"</option>"
            }
            $("#block").html(str);
            
            for (var j = 0; j < studentsDataa[1].length; j++) {

                strl += "<option value=" + studentsDataa[1][j].Mail +">" + studentsDataa[1][j].Fname + " " + studentsDataa[1][j].Lname + "</option>"
            }
            $("#release").html(strl);
        }

        function blockReleaseStudent() {
            StudentMail = $(this).val();

            $(document).on("click", "#blockBTN", function () {

                swal({
                    title: "האם אתה בטוח ?",
                    text: "",
                    icon: "warning",
                    buttons: true,
                    dangerMode: true
                })
                    .then(function (willDelete) {
                        if (willDelete) block(StudentMail);
                        else swal("Not Deleted!");
                    });

            });

            $(document).on("click", "#releaseBTN", function () {

                ajaxCall("PUT", "../api/Ads/blockS?StudentMail=" + StudentMail + "&active=false", "", updateActivitySuccess, error);
        
            });
        }

        function block(StudentMail) {
            ajaxCall("PUT", "../api/Ads/blockS?StudentMail=" + StudentMail + "&active=true", "", updateActivitySuccess, error);
            console.log("test");
        }

           

        function updateActivitySuccess(message) {
            console.log(message);
            ajaxCall("GET", "../api/Ads/getStudentsByActivity", "", getSuccessallstudents, error);

        }


        function error(err) {
            console.log(err)
        }
    </script>
</head>
<body>
    <nav class="navbar navbar-default">
        <div class="container-fluid">
            <ul class="nav navbar-nav">
                <li><a href="AdsTB.html">פרסומים</a></li>
                <li><a href="EventTB.html">אירועים</a></li>
                <li><a href="Questionnaire.html">שאלונים</a></li>
                <li class="active dropdown">
                    <a class="dropbtn" href="Home.html">דף הבית  <i class="fa fa-caret-down"></i></a>
                    <div class="dropdown-content">
                        <a class="dropdown-item" href="BlockandReleaseStudent.html">ניהול משתמשים</a>
                        <a class="dropdown-item" href="StudentForm.html">הוספת משתמש</a>
                    </div>
                </li>
                <li id="titleNav"><a id="navT">היחידת ליזמות חברתית</a></li>
            </ul>
        </div>
    </nav>
    <div class="row">
        <div class="col-sm-6">
            <h3>חסימת סטודנט</h3>
            <select id="block">
            </select>
            <button id="blockBTN">חסום סטודנט </button>
        </div>

        <div class="col-sm-6">
            <h3>שחרור סטודנט</h3>
            <select id="release">
            </select>
            <button id="releaseBTN">שחרר סטודנט </button>
        </div>
    </div>
</body>
</html>